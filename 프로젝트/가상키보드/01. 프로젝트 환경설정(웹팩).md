### 환경

nodeJS, npm, vsCode, Chrome

모듈 번들러(웹팩)

웹팩 - html, css, JS를 하나의 파일 혹은 여러개의 파일로 압축 병합하는 프로그램

### 세팅

- 패키지JSON 초기화
    
    `npm init -y` 
    
- 웹팩 관련 패키지 설치
    
    `npm i -D webpack webpack-cli webpack-dev-server`
    
    <aside>
    🔥  -D ? devDependencies로 설치하겠다는 뜻!
    로컬개발에만 필요한 패키지란 뜻입니다.
    
    -D를 빼면 디펜던시로 설치한다는 뜻!
    프로덕션 환경에서 필요한 패키지란 뜻입니다.
    
    </aside>
    
    웹팩은 버전을 맞추는게 좋습니다.
    
    package.json에서 버전을 변경하고,
    
    터미널에서 `npm i` 를 실행하면 변경된 버전으로 설치가 됩니다.
    
    ```tsx
    "devDependencies": {
        "webpack": "^5.65.0",
        "webpack-cli": "^4.9.1",
        "webpack-dev-server": "^4.7.2"
      }
    ```
    

- 디렉토리를 셋팅합니다.
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7bce5a19-27d0-48b5-9a00-e7d2062e61c7/Untitled.png)
    
- 웹팩설정파일 생성
    
    최상위에 `webpack.config.js` 파일을 생성 후 아래 코드 입력
    
    ```tsx
    const path = require("path");
    
    module.exports = {
      entry: "./src/js/index.js",
      output: {
        filename: "bundle.js",
        path: path.resolve(__dirname, "./dist"),
        clean: true
      }
    }
    ```
    
    설명
    
    ```tsx
    // path라는 모듈을 가져와 웹팩이 절대경롤를 찾을 수 있도록 함
    const path = require("path");
    
    module.exports = {
    	// js 파일의 진입점
      entry: "./src/js/index.js", 
    	// 빌드를 했을 때 번들파일 관련 속성 설정
      output: {
    		// 파일 이름
        filename: "bundle.js",
    		// 번들 파일의 생성 경로 (절대경로를 넣어라!)
        path: path.resolve(__dirname, "./dist"),
    		// 번들 파일 생성시 다른 파일이 있으면 삭제후 새로 생성
        clean: true
      }
    }
    ```
    
- 추가적인 압축 플러그인 설치
    
    `npm i -D terser-webpack-plugin`
    

- 최종 웹팩 환경
    
    ```tsx
    const path = require("path");
    const TerserWebpackPlugin = require('terser-webpack-plugin');
    
    module.exports = {
      entry: "./src/js/index.js",
      output: {
        filename: "bundle.js",
        path: path.resolve(__dirname, "./dist"),
        clean: true
      },
      devtool: "source-map", // 빌드한 파일과 원본 파일을 연결시키는 기능
      mode: "development", // 코드 난독화 기능제공 여부
      optimization: {
        minimizer: [
          new TerserWebpackPlugin()
        ]
      }
    }
    ```
    
- 웹팩 실행
    
    `npx webpack`
    
    그러면 디렉토리에 dist 폴더와 그 안에 bundle.js가 생성됩니다.
    
- 테스트해보기
    
    index.js에 `console.log(”hello”)`를 입력하고 
    
    다시 `npx webpack`을 실행해 봅시다.
    
    그러면 어떤 변화가 생길까요?
    
    1. bundle.js에 우리가 작성한 `console.log(”hello”)`가 포함됩니다.
        
        ```tsx
        /******/ (() => { // webpackBootstrap
        var __webpack_exports__ = {};
        /*!*************************!*\
          !*** ./src/js/index.js ***!
          \*************************/
        console.log("Hello");
        /******/ })()
        ;
        //# sourceMappingURL=bundle.js.map
        ```
        
    2. dist 폴더 안에 [bundle.js.map](http://bundle.js.map) 파일이 생성됩니다.
        
        ```tsx
        {"version":3,"file":"bundle.js","mappings":";;;;;AAAA,qB","sources":["webpack://keybord_event/./src/js/index.js"],"sourcesContent":["console.log(\"Hello\");"],"names":[],"sourceRoot":""}
        ```
        
        [bundle.js.map](http://bundle.js.map) 파일은 아까 웹팩에서 데브툴 설정한 소스맵을 나타내는 파일입니다. 
        
        ```tsx
        devtool: "source-map"
        ```
        
- html 파일을 생성
    
    최상위에 index.html 파일을 생성합니다. 
    
- html과 css를 설정해줄 모듈을 설정합니다.
    
    `npm i -D html-webpack-plugin`
    
    설치 후 꼭 package.json에서 설치여부를 확인하세요!
    
    ```tsx
    "html-webpack-plugin": "^5.5.0"
    ```
    
    `npm i -D mini-css-extract-plugin css-loader css-minimizer-webpack-plugin`
    
    패키지들의 버전을 확인합니다.
    
    ```json
    "devDependencies": {
        "css-loader": "^6.5.1",
        "css-minimizer-webpack-plugin": "^3.3.1",
        "html-webpack-plugin": "^5.5.0",
        "mini-css-extract-plugin": "^2.4.6",
        "terser-webpack-plugin": "^5.3.0",
        "webpack": "^5.65.0",
        "webpack-cli": "^4.9.1",
        "webpack-dev-server": "^4.7.2"
      }
    ```
    
- 웹팩에서 설정값들을 추가 입력합니다.
    
    webpack.config.js에서 입력 중입니다. 
    
    먼저 htmlWebpack설정을 봅시다.
    
    ```json
    plugins: [
        new HtmlWebpack({
    			// html의 타이틀
          title: "keybord",
    			// 사용할 파일 (최상위라 상대경로)
          template: "./index.html",
    			// 파일 빌드 JS를 바디에 넣을거냐 헤더에 넣을거냐는 설정
          inject: "body",
    			// 파비콘 (파일은 다운받아야 겠죠 ㅋㅋ)
          favicon: "./favicon.ico"
        })
      ]
    ```
    
    css 설정도 해봅시다.
    
    ```json
    new MiniCssExtracrPlugin({
          filename: "style.css" 
        })
    ```
    
- module도 설정합니다.
    
    역시 webpack에서 진행합니다.
    
    ```json
    module:{
        rules:[
          {
    				// 모든 css파일을 use의 로더를 이용해 불러들이겠다는 의미입니다.
            test: /\.css$/,
            use: [MiniCssExtracrPlugin.loader, "css-loader"]
          }
        ]
      },
    ```
    
- 현재까지의 웹팩 상황입니다.
    
    ```jsx
    const path = require("path");
    const TerserWebpackPlugin = require('terser-webpack-plugin');
    const HtmlWebpack = require('html-webpack-plugin');
    const MiniCssExtracrPlugin = require('mini-css-extract-plugin');
    const CssMinimizerPlugin = require("css-minimizer-webpack-plugin");
    
    module.exports = {
      entry: "./src/js/index.js",
      output: {
        filename: "bundle.js",
        path: path.resolve(__dirname, "./dist"),
        clean: true
      },
      devtool: "source-map", 
      mode: "development", 
      plugins: [
        new HtmlWebpack({
          title: "keybord",
          template: "./index.html",
          inject: "body",
          // favicon: "./favicon.ico"
        }),
        new MiniCssExtracrPlugin({
          filename: "style.css" 
        })
      ],
      module:{
        rules:[
          {
            test: /\.css$/,
            use: [MiniCssExtracrPlugin.loader, "css-loader"]
          }
        ]
      },
      optimization: {
        minimizer: [
          new TerserWebpackPlugin(),
          new CssMinimizerPlugin()
        ]
      }
    }
    ```
    
- html 로대쉬 문법으로 데이터 바인딩하기
    
    웹팩에서 htmlWebpack 플러그인으로 
    
    타이틀과, 템플릿 등을 설정했었죠. 이 플러그인을 쓰면
    
    html에서 로대쉬 문법을 사용할 수 있게 됩니다.
    
    따라서 html에 들어가 로대쉬 문법으로 데이터를 바인딩 해야 합니다. 
    
    ```html
    <title>
          <%= htmlWebpackPlugin.options.title %>
        </title>
    ```
    
- index.js에 들어가 CSS를 input 합니다.
    
    `import "../css/style.css”`
    
- 테스트를 위해 css를 조금 입력해봅시다.
    
    ```html
    p {
      color: red;
    }
    ```
    
- 편의를 위해 스크립트를 설정합니다.
    
    package.json에 들어가 스크립트를 작성합니다.  
    
    ```html
    "scripts": {
        "build": "webpack --mode=production"
      }
    ```
    

- npm run build 로 실행해봅니다.
    
    그러면 dist 폴더 안에 새로운 파일들이 생깁니다. 내용들을 확인해보세요!
    
    엔터나 띄어쓰기가 없는 모습으로 확인이 될거에요.
    
    위에 mode를 프로덕션으로 해서 그래요. 딱 필요한 코드만 나오게 됩니다. 
    
    이렇게 되면 사용자는 보다 압축된 파일을 받게되니 속도도 더 빠르겠죠? 
    

- devServer를 설정합시다.
    
    다시 웹팩 파일로 돌아갑니다. 
    
    ```jsx
    devServer: {
        host: "localhost",
        port:8080,
    		// 웹팩데브스서버를 열때 마다 브라우저를 새창 열겠다는 뜻
        open:true,
        watchFiles: 'idnex.html'
      },
    ```
    
    잘 설정이 되었는지 확인해봅시다.
    
    `npx webpack-dev-server`
    
    이렇게 되면, 변동사항이  있을 때 새로고침을 안해도 자동으로 변경이 됩니다!
    
- 마지막으로 스크립트를 하나 더 추가합니다.
    
    ```jsx
    "dev": "webpack-dev-server"
    ```
    
    `npm run dev`
    

## 최종

프로젝트 실행 : `npm run dev`

package.json

```jsx
{
  "name": "keybord_event",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "build": "webpack --mode=production",
    "dev": "webpack-dev-server"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "css-loader": "^6.5.1",
    "css-minimizer-webpack-plugin": "^3.3.1",
    "html-webpack-plugin": "^5.5.0",
    "mini-css-extract-plugin": "^2.4.6",
    "terser-webpack-plugin": "^5.3.0",
    "webpack": "^5.65.0",
    "webpack-cli": "^4.9.1",
    "webpack-dev-server": "^4.7.2"
  }
}
```

webpack.config.js

```jsx
const path = require("path");
const TerserWebpackPlugin = require('terser-webpack-plugin');
const HtmlWebpack = require('html-webpack-plugin');
const MiniCssExtracrPlugin = require('mini-css-extract-plugin');
const CssMinimizerPlugin = require("css-minimizer-webpack-plugin");

module.exports = {
  entry: "./src/js/index.js",
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "./dist"),
    clean: true
  },
  devtool: "source-map", 
  mode: "development", 
  devServer: {
    host: "localhost",
    port:8080,
    open:true,
    watchFiles: 'idnex.html'
  },
  plugins: [
    new HtmlWebpack({
      title: "keybord",
      template: "./index.html",
      inject: "body",
      // favicon: "./favicon.ico"
    }),
    new MiniCssExtracrPlugin({
      filename: "style.css" 
    })
  ],
  module:{
    rules:[
      {
        test: /\.css$/,
        use: [MiniCssExtracrPlugin.loader, "css-loader"]
      }
    ]
  },
  optimization: {
    minimizer: [
      new TerserWebpackPlugin(),
      new CssMinimizerPlugin()
    ]
  }
}
```